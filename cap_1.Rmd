

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

library(easypackages)
my_packages <- c("tidyverse", "googlesheets", "extrafont", "ggrepel", "xtable")
libraries(my_packages)


dna <- gs_title("dna") %>%
  gs_read(ws = "Mayo")


```


# AVAILABLE BUILDINGS IN TIJUANA MARKETS AT Q1 2018

En la primera tabla observamos el precio de arrendamient en el submercado _El Florido - Boulevard 2000_, el cual se encuentra entre $\$0.44 * ft^2$ y $\$0.55* ft^2$ dll . La nave industrial cuyo precio es el más alto es la nave Truper que arrienda Bustamante Realty Group. 

En la siguiente tabla se muestra el precio de arrendamiento para el submercado Pacífico - Nordika, el precio de arrendamiento en este submercado, según datos de _SOLILI_ varía entre $\$40 * ft^2$ y $\$45 * ft^2$ 

En la siguiente gráfica se incluye el precio de arrendamiento promedio por submercado, ordenados de mayor a menor. En promedio, el submercado con mayor precio de arrendamiento por pie cuadrado es _El Florido - Boulevard 2000_ posteriormente, _Pacífico - Nordika_, _Otay - Alamar_, _Insurgentes - El Águila_ y, _La Mesa - Vía Rápida_. 


```{r warning=FALSE,  echo=FALSE, results='asis'}


t1 <- xtable(dna %>%
               select(`Empresa de Arrendamiento`, Nombre, Submercado, costo_de_arrendamiento) %>%
               group_by(Submercado, `Empresa de Arrendamiento`, Nombre) %>%
               summarise(lease = mean(costo_de_arrendamiento, na.rm = TRUE)) %>%
               spread(Submercado, lease) %>%
               select(`Empresa de Arrendamiento`, `Nombre`, `El Florido - Boulevard 2000`, `Pacifico - Nordika`,
                      `Otay - Alamar`, `Insurgentes - El Aguila`, `La mesa - Via Rapida`) %>%
               arrange_(., ~desc(`El Florido - Boulevard 2000`,`Pacifico - Nordika`, `Otay - Alamar`,`Insurgentes - El Aguila`, `La Mesa - Via Rapida`)))


print.xtable(t1, comment = FALSE, caption.placement = "top", include.rownames = FALSE, size = c("\\setlength{\\tabcolsep}{1pt}\\fontsize{7pt}{10pt}\\selectfont"), scalebox = 0.7, booktabs = TRUE, floating = FALSE, latex.environments = "", table.placement = "H")

```


##Leasing rates by submarkets and brokerage firm


```{r warning=FALSE,  echo=FALSE, fig.width=5.5, fig.height=3.5, fig.show='hold', fig.align='left', results='asis'}

dna %>%
  select(`Empresa de Arrendamiento`, Nombre, Submercado, costo_de_arrendamiento) %>%
  group_by(Submercado)                                                           %>% 
  summarise(lease = mean(costo_de_arrendamiento, na.rm = TRUE),
         n = n())                                                                %>%
  ggplot(aes(x = reorder(Submercado,lease), lease, colour = Submercado)) + 
  geom_point(size = .5) + 
  geom_text_repel(aes(label = factor(n))) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none", 
        title            = element_text(size   = 10,
                                        family = "Roboto Condensed Light",
                                        color  = "#ca2128"),
        axis.title.x     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.title.y     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.text.x      = element_text(angle  = 45,
                                        hjust  = 1,
                                        size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        axis.text.y      = element_text(size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        plot.subtitle    = element_text(size   = 6,
                                        color  = "black"),
        plot.caption     = element_text(color  = "#191919",
                                        size   = 5,
                                        family = "Roboto Thin"),
        panel.grid.major = element_line(size   = 0.5)) + 
  xlab(label = "Submarket") +
  ylab(label = "Leasing rate") +
  ggtitle("Average lease rate by submarket")

```




```{r warning=FALSE,  echo=FALSE, fig.width=5.5, fig.height=3.5, fig.show='hold', fig.align='left', results='asis'}
dna %>%
  select(`Empresa de Arrendamiento`, Nombre, Submercado, costo_de_arrendamiento) %>%
  group_by(`Empresa de Arrendamiento`, Submercado) %>% 
  summarise(lease = mean(costo_de_arrendamiento, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(`Empresa de Arrendamiento`,lease), lease)) + 
  geom_point(aes(colour = Submercado), size = .2) +
  theme_minimal() +
  xlab(label = NULL) +
  ylab(label = "Leasing rate") +
  theme(legend.title = element_text(size = 6, face = "bold"), legend.text = element_text(size = 5), legend.position = "bottom", axis.text = element_text(size = 7), legend.justification = c("left")) +
  ggtitle("Leasing rate by brokerage firm") +
  theme(legend.position = "none", 
        title            = element_text(size   = 10,
                                        family = "Roboto Condensed Light",
                                        color  = "#ca2128"),
        axis.title.x     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.title.y     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.text.x      = element_text(angle  = 45,
                                        hjust  = 1,
                                        size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        axis.text.y      = element_text(size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        plot.subtitle    = element_text(size   = 6,
                                        color  = "black"),
        plot.caption     = element_text(color  = "#191919",
                                        size   = 5,
                                        family = "Roboto Thin"),
        panel.grid.major = element_line(size   = 0.5))
```






```{r warning=FALSE, echo=FALSE, fig.width=5.5, fig.height=3.5, fig.show='hold', fig.align='left', results='asis'}
dna %>%
  select(`Empresa de Arrendamiento`, Nombre, Submercado, costo_de_arrendamiento, Desarrollardor) %>%
  group_by(Submercado, Nombre, `Empresa de Arrendamiento`, Desarrollardor) %>% 
  summarise(lease = mean(costo_de_arrendamiento, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(Submercado, lease), y = lease)) + 
  geom_boxplot() +
  geom_point(size = .2) +
  theme_minimal() + 
  xlab(label =  "Submarket") +
  ylab(label = "Leasing rate") +
  ggtitle("Average asking price dispersion by submarket") +
  theme(legend.position = "none", 
        title            = element_text(size   = 10,
                                        family = "Roboto Condensed Light",
                                        color  = "#ca2128"),
        axis.title.x     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.title.y     = element_text(size   = 8,
                                        colour = "black",
                                        family = "Roboto Black",
                                        color  = "#666666"),
        axis.text.x      = element_text(angle  = 45,
                                        hjust  = 1,
                                        size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        axis.text.y      = element_text(size   = 8,
                                        family = "Roboto Thin",
                                        color  = "#000000"),
        plot.subtitle    = element_text(size   = 6,
                                        color  = "black"),
        plot.caption     = element_text(color  = "#191919",
                                        size   = 5,
                                        family = "Roboto Thin"),
        panel.grid.major = element_line(size   = 0.5))
```





